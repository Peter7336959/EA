<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>暴露風險評估：模型參數的實驗測定資訊圖表</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0KOVEMckDpbDMBIZB/iA3neebcuH8RzLG/gdWM8rMUEA9PIvlCxfg" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        .gradient-text {
            background: linear-gradient(to right, #bc5090, #ff6361);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .katex-display {
            margin: 0.5em 0;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-6xl font-black text-[#003f5c] mb-2">模型參數預估：合理推估</h1>
            <p class="text-xl md:text-2xl font-bold text-[red]">當評估數據參數缺失時的工業衛生策略</p>
            <p class="max-w-3xl mx-auto mt-4 text-gray-600">
                準確的暴露風險評估需要可靠的輸入參數。但當關鍵的污染物發生率 (G) 和房間換氣率 (Q) 未知時該怎麼辦？本案例展示了如何透過創新的實驗方法，主動獲取數據，從而建立可信的評估模型。
            </p>
        </header>

        <main class="space-y-12">

            <section id="solution" class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center text-[#003f5c] mb-6">解決方案：設計實驗創造數據</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

                    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <h3 class="text-2xl font-bold text-[#58508d] mb-4 text-center">測定粉塵逸散率 (G)</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-bold text-lg">實驗設計</h4>
                                <p class="text-sm text-gray-600">為量化投料作業的粉塵逸散量，我們建立了一個 8x8x8 英尺的密閉測試艙，模擬實際作業。艙體設有抽氣系統，能將內部空氣完全抽出並通過一組預先秤重的高效率濾紙 (MERV 16)。</p>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg">執行方式</h4>
                                <p class="text-sm text-gray-600">作業人員在艙內模擬將五袋50磅的粉末倒入桶中。作業結束後，持續抽氣確保所有懸浮粉塵均被濾紙捕集。實驗重複六次以確保數據的可靠性。</p>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg">數據產出</h4>
                                <p class="text-sm text-gray-600">通過測量濾紙增加的平均重量 (9,000 mg) 並除以作業時間 (5 min)，我們精確計算出逸散率 G = 1,800 mg/min。</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                        <h3 class="text-2xl font-bold text-[#58508d] mb-4 text-center">測定房間換氣率 (Q)</h3>
                         <div class="space-y-4">
                            <div>
                                <h4 class="font-bold text-lg">實驗設計</h4>
                                <p class="text-sm text-gray-600">為測量無機械通風大型廠房的自然換氣率，我們採用了示蹤氣體衰退法。利用廠內現有的丙烷堆高機，讓其短時間行駛，將其排放的一氧化碳 (CO) 作為示蹤氣體。</p>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg">執行方式</h4>
                                <p class="text-sm text-gray-600">堆高機行駛10分鐘後離開，使CO在廠房內均勻混合。隨後，使用直讀式CO偵測器，在廠房中央連續記錄CO濃度隨時間自然衰減的數據長達50分鐘。</p>
                            </div>
                             <div>
                                <h4 class="font-bold text-lg">數據產出</h4>
                                <p class="text-sm text-gray-600">將濃度衰退數據進行線性回歸分析，根據公式 $-\ln(C_t/C_0) = (Q/V) \cdot t$ 的斜率，計算出換氣率 Q ≈ 45.3 m³/min。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="scenario" class="text-center">
                 <h2 class="text-3xl font-bold text-[#003f5c] mb-4">綜合情境：高風險的組合</h2>
                 <p class="max-w-3xl mx-auto text-gray-600">
                    現在，我們將這兩個獨立的實驗結果結合：一個高粉塵逸散的作業，在一個通風極差的大型廠房中進行。這為我們的暴露風險評估模型提供了完整的參數。
                 </p>
            </section>

            <section id="modeling" class="bg-white rounded-lg shadow-lg p-6 md:p-8 grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="text-center md:text-left">
                    <h2 class="text-3xl font-bold text-[#003f5c] mb-4">模型計算結果</h2>
                    <p class="text-gray-600 mb-6">
                        我們採用均勻混合模型來估算遠場工作者的8小時日時量平均濃度 (TWA-8)。此模型考慮了污染物發生率、房間換氣率以及間歇性的作業模式（每小時3次，每次5分鐘）。
                    </p>
                    <div class="bg-[#003f5c] text-white p-6 rounded-lg text-center">
                        <p class="text-lg font-bold">預估 8小時日時量平均濃度 (TWA-8)</p>
                        <p class="text-7xl font-black gradient-text py-2">9.9</p>
                        <p class="text-lg font-bold">mg/m³</p>
                    </div>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border border-gray-200">
                    <h3 class="font-bold text-lg mb-2 text-[#58508d]">計算公式</h3>
                    <p class="text-sm text-gray-600 mb-4">首先計算穩態濃度 $C_{ss}$，然後根據作業時間計算 TWA-8。</p>
                    <div class="text-lg bg-gray-800 text-white p-4 rounded-md font-mono text-center">
                        <p>$$C_{ss} = \frac{G}{Q} = \frac{1,800 \text{ mg/min}}{45.3 \text{ m³/min}} \approx 39.7 \text{ mg/m³}$$</p>
                        <hr class="my-3 border-gray-600">
                        <p>$$\text{TWA-8} = \frac{C_{ss} \times (15 \text{ min/hr} \times 8 \text{ hr})}{480 \text{ min}} \approx 9.9 \text{ mg/m³}$$</p>
                    </div>
                </div>
            </section>

            <section id="verdict" class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center text-[#003f5c] mb-2">風險評估：與職業暴露基準比較</h2>
                <p class="text-center max-w-3xl mx-auto text-gray-600 mb-8">
                    將計算出的 9.9 mg/m³ 暴露濃度與美國OSHA和ACGIH的職業暴露基準 (OELs) 進行比較。圖表清晰地顯示，雖然總粉塵暴露在容許範圍內，但對健康危害更大的**可呼吸性粉塵**已嚴重超標。
                </p>
                <div class="chart-container">
                    <canvas id="exposureChart"></canvas>
                </div>
            </section>

            <section id="action-plan">
                <h2 class="text-3xl font-bold text-center text-[#003f5c] mb-8">行動計畫：基於數據的專業建議</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-5xl mb-4">1️⃣</div>
                        <h3 class="text-xl font-bold text-[#58508d] mb-2">工程控制</h3>
                        <p class="text-gray-600">最優先的措施是在攪拌機投料口安裝局部排氣通風系統 (LEV)，從源頭捕集粉塵。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-5xl mb-4">2️⃣</div>
                        <h3 class="text-xl font-bold text-[#bc5090] mb-2">暴露監測</h3>
                        <p class="text-gray-600">立即對現場人員實施個人空氣採樣，特別是可呼吸性粉塵，以驗證模型並確認實際暴露水平。</p>
                    </div>
                    <div class="bg-white rounded-lg shadow-lg p-6 text-center">
                        <div class="text-5xl mb-4">3️⃣</div>
                        <h3 class="text-xl font-bold text-[#ff6361] mb-2">行政管理與個人防護</h3>
                        <p class="text-gray-600">在改善完成前，限制非必要人員進入，並要求所有人員佩戴適當的呼吸防護具 (如N95)。</p>
                    </div>
                </div>
            </section>
            
            <section id="conclusion" class="bg-white rounded-lg shadow-lg p-6 md:p-8 text-center">
                <h2 class="text-3xl font-bold text-[#003f5c] mb-4">總結：數據賦予評估力量</h2>
                <p class="max-w-3xl mx-auto text-gray-600">
                    本案例證明，即使在缺乏現成數據的挑戰下，工業衛生師也能透過科學的實驗設計，主動獲取關鍵模型參數。這種「化被動為主動」的策略，不僅能建立可靠的暴露評估模型，更能為制定有效的控制措施提供堅實的數據支持，最終實現保護工作者健康的目標。
                </p>
            </section>

        </main>

        <footer class="text-center mt-12 pt-8 border-t border-gray-300">
            <p class="text-gray-500">此資訊圖表根據《A Case-Based Introduction to Modeling Occupational Inhalation Exposures to Chemicals》第十一章內容製作。</p>
            <p class="text-sm text-gray-400 mt-2">Made by Peter Ho. 114.08.17</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false},
                    {left: "\\(", right: "\\)", display: false},
                    {left: "\\[", right: "\\]", display: true}
                ]
            });
        
            function wrapLabel(str, maxWidth) {
                if (str.length <= maxWidth) {
                    return str;
                }
                const words = str.split(' ');
                let lines = [];
                let currentLine = '';
                words.forEach(word => {
                    if ((currentLine + ' ' + word).trim().length > maxWidth) {
                        lines.push(currentLine.trim());
                        currentLine = word;
                    } else {
                        currentLine = (currentLine + ' ' + word).trim();
                    }
                });
                if (currentLine) {
                    lines.push(currentLine.trim());
                }
                return lines;
            }

            const ctx = document.getElementById('exposureChart').getContext('2d');
            
            const rawLabels = [
                'ACGIH TLV (Respirable PNOC)', 
                'OSHA PEL (Respirable)', 
                'ACGIH TLV (Inhalable PNOC)',
                'OSHA PEL (Total Dust)'
            ];

            const chartLabels = rawLabels.map(label => wrapLabel(label, 16));

            const exposureValue = 9.9;
            const limitValues = [3, 5, 10, 15];

            const chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartLabels,
                    datasets: [
                    {
                        label: '暴露基準 (OEL)',
                        data: limitValues,
                        backgroundColor: '#58508d',
                        borderColor: '#003f5c',
                        borderWidth: 2,
                        borderRadius: 5,
                        borderSkipped: false,
                    },
                    {
                        label: '預估暴露濃度 (TWA-8)',
                        data: limitValues.map(() => exposureValue),
                        backgroundColor: (context) => {
                            const limit = limitValues[context.dataIndex];
                            return exposureValue > limit ? '#ff6361' : '#ffa600';
                        },
                        borderColor: (context) => {
                            const limit = limitValues[context.dataIndex];
                            return exposureValue > limit ? '#bc5090' : '#ff6361';
                        },
                        borderWidth: 2,
                        borderRadius: 5,
                        borderSkipped: false,
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '濃度 (mg/m³)',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        },
                        y: {
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: '預估暴露濃度 vs. 職業暴露基準 (OELs)',
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            padding: {
                                top: 10,
                                bottom: 20
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: function(tooltipItems) {
                                    const item = tooltipItems[0];
                                    let label = item.chart.data.labels[item.dataIndex];
                                    if (Array.isArray(label)) {
                                      return label.join(' ');
                                    } else {
                                      return label;
                                    }
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>
